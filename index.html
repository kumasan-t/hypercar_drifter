<html>
    <head>
        <title>TODO supply a title</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="./js/hand.minified-1.2.js"></script>
        <script src="./js/cannon.js"></script>  
        <script src="./js/babylon.js"></script>
        <script src="./js/direction.js"></script>
        <script src="./js/obstacles.js"></script>
        <script src="./js/planes.js"></script>
        <script src="./js/crash.js"></script>
        <script src="./js/gameover.physics.js"></script>
        <script src="./js/gui.js"></script>
        <script src="./js/restart.js"></script>
        <script src="./js/entities/barrel.js"></script>
        <script src="./js/entities/propeller.js"></script>
        <script src="./js/scenes/mainmenu.scene.js"></script>
        <script src="./js/scenes/game.scene.js"></script>
        
        <link href="./css/mainstyle.css" rel="stylesheet" type="text/css">



    </head>
    <body>
        <div id="container">
            <div id="counter">0</div>
            <div id="gameover">
                <div id="gameover-text">GAME OVER</div>
                <div id="speed-text">Speed: 120 m/s</div>
                <div id="distance-text">Distance: 1234.5 m</div>
            </div>
            <canvas id="renderCanvas"></canvas>
        </div>

        <script>
            var canvas = document.getElementById("renderCanvas");
            var engine = new BABYLON.Engine(canvas, false, null, false);
            var car;
            var carSpeed = 3;
            var obstacleSpeed = 1;
            var obstaclesManager;
            var planeManager = new Plane(-10, 50);
            var specularLight;
            var propellerCenterMaterial;
            var blackColor;
            
            var meshCar;
            var meshCarGround;
            var meshBarrel;
            var meshPlane;
            var meshAirScrew;
            var meshPropellerCenter;

            var fountain;
            var fountain2;
            
            var globalTime = 0;
            
            var carLoaded = false;
            var barrelLoaded = false;
            var propellerLoaded = false;
            var propellerCenterLoaded = false;
            var airScrewLoaded = false;
            var planeLoaded = false;

            var menuScene = mainMenuScene();
            var gameScene = gameScene();
            var currentScene = menuScene;
            
            var keys = {
                left: 0,
                right: 0,
                up: 0,
                down: 0
            };
            window.addEventListener("keydown", handleKeyDown, false);
            window.addEventListener("keyup", handleKeyUp, false);
            function handleKeyDown(evt) {
                if (evt.keyCode == 65) {
                    //A        
                    keys.left = 1;
                }
                if (evt.keyCode == 68) {//D        
                    keys.right = 1;
                }
                if (evt.keyCode == 87) {//W        
                    keys.up = 1;
                }
                if (evt.keyCode == 83) {//S        
                    keys.down = 1;
                }
            }

            function handleKeyUp(evt) {
                if (evt.keyCode == 65) {
                    keys.left = 0;
                }
                if (evt.keyCode == 68) {
                    keys.right = 0;
                }
                if (evt.keyCode == 87) {
                    keys.up = 0;
                }
                if (evt.keyCode == 83) {
                    keys.down = 0;
                }
            }

            var frameCount = 0;
            
            engine.runRenderLoop(function () {
                globalTime += 1 / engine.fps;
                
                currentScene.update();
                currentScene.render();
            });

            window.addEventListener("resize", function () {
                engine.resize();
            });
        </script>
    </body>
</html>